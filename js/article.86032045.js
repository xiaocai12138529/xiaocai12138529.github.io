(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["article"],{2072:function(t,e,n){},2423:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return i})),n.d(e,"e",(function(){return o})),n.d(e,"c",(function(){return c})),n.d(e,"f",(function(){return s})),n.d(e,"g",(function(){return l})),n.d(e,"d",(function(){return u}));var r=n("b775"),a=function(t,e){return Object(r["a"])({url:"/v1_0/articles",params:{channel_id:t,timestamp:e}})},i=function(t){return Object(r["a"])({url:"/v1_0/article/dislikes",method:"POST",data:{target:t}})},o=function(t,e){return Object(r["a"])({url:"/v1_0/article/reports",method:"POST",data:{target:t,type:e}})},c=function(t){return Object(r["a"])({url:"v1_0/articles/"+t})},s=function(t){return Object(r["a"])({method:"POST",url:"/v1_0/user/followings",data:{target:t}})},l=function(t){return Object(r["a"])({url:"/v1_0/user/followings/"+t,method:"DELETE"})},u=function(t,e){return Object(r["a"])({url:"/v1_0/comments",method:"GET",params:{type:"a",source:t,offset:e}})}},2909:function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t){if(Array.isArray(t))return r(t)}n.d(e,"a",(function(){return s}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630");function i(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}n("fb6a"),n("b0c0");function o(t,e){if(t){if("string"===typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t){return a(t)||i(t)||o(t)||c()}},"4df4":function(t,e,n){"use strict";var r=n("0366"),a=n("7b0b"),i=n("9bdd"),o=n("e95a"),c=n("50c4"),s=n("8418"),l=n("35a1");t.exports=function(t){var e,n,u,d,m,f,v=a(t),h="function"==typeof this?this:Array,p=arguments.length,b=p>1?arguments[1]:void 0,g=void 0!==b,_=l(v),w=0;if(g&&(b=r(b,p>2?arguments[2]:void 0,2)),void 0==_||h==Array&&o(_))for(e=c(v.length),n=new h(e);e>w;w++)f=g?b(v[w],w):v[w],s(n,w,f);else for(d=_.call(v),m=d.next,n=new h;!(u=m.call(d)).done;w++)f=g?i(d,b,[u.value,w],!0):u.value,s(n,w,f);return n.length=w,n}},8982:function(t,e,n){"use strict";n("2072")},9316:function(t,e,n){},"9bdd":function(t,e,n){var r=n("825a"),a=n("2a62");t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(o){throw a(t),o}}},a630:function(t,e,n){var r=n("23e7"),a=n("4df4"),i=n("1c7e"),o=!i((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:o},{from:a})},d856:function(t,e,n){"use strict";n("9316")},f2b4:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-container",attrs:{id:"xxx"}},[n("van-nav-bar",{attrs:{fixed:"","left-arrow":"",title:"文章详情"},on:{"click-left":function(e){return t.$router.back()}}}),t.loading?n("van-loading",{staticClass:"article-loading"}):t._e(),t.is404?t._e():n("div",{staticClass:"detail"},[n("h1",{staticClass:"title"},[t._v(t._s(t.article.title))]),n("div",{staticClass:"author"},[n("van-image",{attrs:{round:"",width:"1rem",height:"1rem",fit:"fill",src:t.article.aut_photo}}),n("div",{staticClass:"text"},[n("p",{staticClass:"name"},[t._v(t._s(t.article.aut_name))]),n("p",{staticClass:"time"},[t._v(t._s(t._f("relativeTime")(t.article.pubdate)))])]),n("van-button",{attrs:{round:"",size:"small",type:"info"},on:{click:function(e){return t.toggleConcern()}}},[t._v(t._s(t.article.is_followed?"已关注":" +关注"))])],1),n("div",{staticClass:"content"},[n("div",{class:{content_hidden:t.isShow},domProps:{innerHTML:t._s(t.article.content)}}),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],staticClass:"bg-gradient"},[n("p",{on:{click:t.isShowArticle}},[t._v("显示更多 "),n("van-icon",{attrs:{name:"arrow-down"}})],1)])]),n("van-divider",[t._v("猜你喜欢")]),n("div",{staticClass:"zan"},[n("van-button",{attrs:{round:"",size:"small",hairline:"",type:"primary",plain:"",icon:"good-job-o"}},[t._v("点赞")]),t._v("      "),n("van-button",{attrs:{round:"",size:"small",hairline:"",type:"danger",plain:"",icon:"delete"}},[t._v("不喜欢")])],1)],1),t.is404?n("div",{staticClass:"error"},[n("p",[t._v("文章被外星人吃掉了")]),n("van-button",{on:{click:function(e){return t.$router.back()}}},[t._v("后退")]),n("van-button",{on:{click:function(e){return t.$router.push("/")}}},[t._v("回主页")])],1):t._e(),t.is404?t._e():n("comment")],1)},a=[],i=n("1da1"),o=(n("96cf"),n("2423")),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-comments",attrs:{id:"top"}},[n("div",{attrs:{id:"chatContainer"}}),n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(e){return n("van-cell",{key:e.com_id},[n("van-image",{staticStyle:{"margin-right":"10px"},attrs:{slot:"icon",round:"",width:"30",height:"30",src:e.aut_photo},slot:"icon"}),n("span",{staticStyle:{color:"#466b9d"},attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.aut_name))]),n("div",{attrs:{slot:"label"},slot:"label"},[n("p",{staticStyle:{color:"#363636"}},[t._v(t._s(e.content))]),n("p",[n("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(t._f("relativeTime")(e.pubdate)))])])]),n("van-icon",{attrs:{slot:"right-icon",name:e.is_liking?"like":"like-o"},on:{click:function(n){return t.hToggleLike(e)}},slot:"right-icon"})],1)})),1),n("div",{class:t.commentShow?"art-cmt-container-1":"art-cmt-container-2"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.commentShow,expression:"commentShow"}],staticClass:"add-cmt-box van-hairline--top"},[n("van-icon",{attrs:{name:"arrow-left",size:"24px"},on:{click:function(e){return t.$router.back()}}}),n("div",{staticClass:"ipt-cmt-div",on:{click:t.hShowCommentArea}},[t._v("发表评论")]),n("div",{staticClass:"icon-box"},[n("van-badge",{attrs:{content:t.total_count,max:"99"}},[n("van-icon",{attrs:{name:"comment-o",size:"24px"}})],1),n("van-icon",{attrs:{name:"star-o",size:"24px"}}),n("van-icon",{attrs:{name:"share-o",size:"24px"}})],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.commentShow,expression:"!commentShow"}],staticClass:"cmt-box van-hairline--top"},[n("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.commentText,expression:"commentText",modifiers:{trim:!0}}],ref:"txt",attrs:{placeholder:"友善评论、理性发言、阳光心灵"},domProps:{value:t.commentText},on:{blur:[t.hBlur,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.commentText=e.target.value.trim())}}}),n("van-button",{attrs:{type:"default"},on:{click:t.hAddComment}},[t._v(" 发布")])],1)])],1)},s=[],l=n("2909"),u=n("b775"),d=function(t,e){return Object(u["a"])({method:"POST",url:"v1_0/comments",data:{target:t,art_id:t,content:e}})},m=function(t){return Object(u["a"])({method:"POST",url:"v1_0/comment/likings",data:{target:t}})},f=function(t){return Object(u["a"])({method:"DELETE",url:"v1_0/comment/likings/"+t})},v={name:"ArticleComment",data:function(){return{commentText:"",commentShow:!0,offset:null,total_count:0,list:[],loading:!1,finished:!1}},methods:{hToggleLike:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:try{r=t.is_liking,a=t.com_id,r?(f(a),e.$toast.success("取消点赞成功")):(m(a),e.$toast.success("点赞成功")),t.is_liking=!r}catch(i){e.$toast.fail("操作失败")}case 1:case"end":return n.stop()}}),n)})))()},hAddComment:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d(t.$route.params.id,t.commentText);case 3:n=e.sent,r=n.data.data.new_obj,r.is_liking=!1,t.list.unshift(r),a=t.$el.offsetTop,t.$el.querySelector("#chatContainer").parentNode.parentNode.scroll({top:a-100,left:0,behavior:"smooth"}),t.total_count=t.total_count+1,t.commentText="",e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))()},hBlur:function(){var t=this;setTimeout((function(){t.commentShow=!0}))},hShowCommentArea:function(){var t=this;this.commentShow=!1,this.$nextTick((function(){t.$refs.txt.focus()}))},onLoad:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["d"])(t.$route.params.id,t.offset);case 2:if(r=e.sent,t.total_count=r.data.data.total_count,a=r.data.data.results,(n=t.list).push.apply(n,Object(l["a"])(a)),t.loading=!1,!(a.length<10)){e.next=11;break}return t.finished=!0,e.abrupt("return");case 11:t.offset!==r.data.data.last_id&&(t.offset=r.data.data.last_id);case 12:case"end":return e.stop()}}),e)})))()}}},h=v,p=(n("8982"),n("2877")),b=Object(p["a"])(h,c,s,!1,null,"81b9b4f0",null),g=b.exports,_={name:"ArticleIndex",data:function(){return{loading:!0,article:{},isShow:!0,is404:!1}},components:{Comment:g},created:function(){this.getarticles()},methods:{getarticles:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,Object(o["c"])(t.$route.params.id);case 4:n=e.sent,t.article=n.data.data,t.loading=!1,t.$toast("获取成功"),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),t.loading=!1,404===e.t0.response.status&&(t.is404=!0);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))()},isShowArticle:function(){this.isShow=!1},toggleConcern:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.article,r=n.is_followed,a=n.aut_id,e.prev=1,r){e.next=11;break}return e.next=5,Object(o["f"])(a);case 5:e.sent,t.$toast.success("加关成功"),t.article.is_followed=!0,e.next=17;break;case 11:return e.next=13,Object(o["g"])(a);case 13:e.sent,t.$toast.success("取关成功"),t.article.is_followed=!1;case 17:e.next=24;break;case 19:e.prev=19,e.t0=e["catch"](1),400===e.t0.response.status&&t.$toast.fail("不能关注自己"),401===e.t0.response.status&&t.$toast.fail("请先登录");case 24:case"end":return e.stop()}}),e,null,[[1,19]])})))()}}},w=_,x=(n("d856"),Object(p["a"])(w,r,a,!1,null,"be54fb7e",null));e["default"]=x.exports},fb6a:function(t,e,n){"use strict";var r=n("23e7"),a=n("861d"),i=n("e8b5"),o=n("23cb"),c=n("50c4"),s=n("fc6a"),l=n("8418"),u=n("b622"),d=n("1dde"),m=d("slice"),f=u("species"),v=[].slice,h=Math.max;r({target:"Array",proto:!0,forced:!m},{slice:function(t,e){var n,r,u,d=s(this),m=c(d.length),p=o(t,m),b=o(void 0===e?m:e,m);if(i(d)&&(n=d.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)?a(n)&&(n=n[f],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return v.call(d,p,b);for(r=new(void 0===n?Array:n)(h(b-p,0)),u=0;p<b;p++,u++)p in d&&l(r,u,d[p]);return r.length=u,r}})}}]);
//# sourceMappingURL=article.86032045.js.map